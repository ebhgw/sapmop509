<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE servicecenter PUBLIC "-//Novell, Inc.//DTD hierarchy 2.0//EN" "ServiceCenterConfiguration_1.0.dtd">


<!--
 Copyright (c) 2010 Novell, Inc.  All Rights Reserved.

 THIS WORK IS SUBJECT TO U.S. AND INTERNATIONAL COPYRIGHT LAWS AND TREATIES.  IT MAY NOT BE USED, COPIED,
 DISTRIBUTED, DISCLOSED, ADAPTED, PERFORMED, DISPLAYED, COLLECTED, COMPILED, OR LINKED WITHOUT NOVELL'S
 PRIOR WRITTEN CONSENT. USE OR EXPLOITATION OF THIS WORK WITHOUT AUTHORIZATION COULD SUBJECT THE
 PERPETRATOR TO CRIMINAL AND CIVIL LIABILITY.

 NOVELL PROVIDES THE WORK "AS IS," WITHOUT ANY EXPRESS OR IMPLIED WARRANTY, INCLUDING WITHOUT THE
 IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT. NOVELL,
 THE AUTHORS OF THE WORK, AND THE OWNERS OF COPYRIGHT IN THE WORK ARE NOT LIABLE FOR ANY CLAIM,
 DAMAGES, OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT, OR OTHERWISE, ARISING FROM, OUT OF,
 OR IN CONNECTION WITH THE WORK OR THE USE OR OTHER DEALINGS IN THE WORK.
-->

<!--
  Please refer to the ServiceCenterConfiguration_1.0.dtd file in your Formula(tm)
  installation directory for details on the definition of this file.
-->

<servicecenter>

   <!--=====================
     General properties
   ======================-->

	<properties>

          <connection>
              <!-- Connection checking URL. If a Formula ServiceCenter Adapter cannot connect
                   to this URL, then it is assumed the ServiceCenter Server is down. -->
              <testURL>http://{adapter.hostname}:{adapter.hostport}/SM/7/IncidentManagement.wsdl</testURL>
          </connection>

      </properties>

      <!-- Define properties used for later substitution -->
      <property name="root.soap.xmlns">
           <![CDATA[
                 xmlns:wsdl="http://schemas.xmlsoap.org/wsdl"
				xmlns:cmn="http://schemas.hp.com/SM/7/Common"
                xmlns:ns="http://schemas.hp.com/SM/7"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
           ]]>
      </property>
      <property name="root.soap.envelope">
           <![CDATA[
                <?xml version="1.0" encoding="UTF-8"?>
                <SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
                                   xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"
                                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                                   xmlns:xsd="http://www.w3.org/2001/XMLSchema">
                <SOAP-ENV:Body>{soap.body}</SOAP-ENV:Body>
                </SOAP-ENV:Envelope>
           ]]>
      </property>
      <property name="root.soap.endpoint.prefix">http://{adapter.hostname}:{adapter.hostport}/SM/7</property>
      <property name="root.soap.namespace">http://schemas.hp.com/SM/7</property>

   <!--==============================================================
     Configuration for the Incident Management ServiceCenter Module
   ===============================================================-->

  <module name="Incident" enable="true">

    <!-- Define processing properties -->
    <properties>
      <formula>
        <fields>
          <!-- Formula expects 5 fields for normalization:
                              status, lastUpdate, key, description, assignedTo -->
          <status>Status</status>
          <lastUpdate>UpdatedTime</lastUpdate>
          <key>IncidentID</key>
          <description>Description</description>
          <assignedTo>Assignee</assignedTo>
        </fields>
        <severities>
          <!-- Map normalized status field values to Formula Alarm Severities -->
          <item fromRE="Open" toSeverity="INFO"/>
          <item fromRE="Work In Progress" toSeverity="INFO"/>
          <item fromRE="Resolved" toSeverity="INFO"/>
          <item fromRE="Reopened" toSeverity="MAJOR"/>
          <item fromRE="Closed" toSeverity="OK"/>
          <item fromRE="Accepted" toSeverity="MINOR"/>
          <item fromRE=".*ALERT.*" toSeverity="CRITICAL"/>
          <item fromRE=".*" toSeverity="MAJOR"/>
        </severities>
      </formula>
      <soap>
        <endpoint>{root.soap.endpoint.prefix}/IncidentManagement.wsdl</endpoint>
        <namespace>{root.soap.namespace}</namespace>
        <server>IncidentManagement</server>
        <port>IncidentManagement</port>
        <username>{adapter.username}</username>
        <password>{adapter.password}</password>
        <operations>

          <!-- Polling Operations -->
          <pollKeys>
            <name>RetrieveIncidentKeysList</name>
            <envelope>{root.soap.envelope}</envelope>
            <body>
              <![CDATA[
                                        <ns:RetrieveIncidentKeysListRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys></ns:keys>
                                                  <ns:instance>
                                                       <ns:UpdatedTime>&gt;={formula.poll.from.time}</ns:UpdatedTime>
                                                       <ns:Status>&gt;&lt;Closed</ns:Status>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:RetrieveIncidentKeysListRequest>
                                   ]]>
            </body>
            <response>&gt;RetrieveIncidentKeysListResponse</response>
            <instance>
              <container>keys</container>
              <typeattribute>type</typeattribute>
            </instance>
            <date>
              <initial>1900-01-01T00:00:00</initial>
              <format>yyyy-MM-dd''T''HH:mm:ss''+''hh</format>
            </date>
          </pollKeys>
          <getPollRecords>
            <name>RetrieveIncidentList</name>
            <envelope>{root.soap.envelope}</envelope>
            <body>
              <![CDATA[
                                        <ns:RetrieveIncidentListRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  {formula.poll.keys}	
                                             </ns:model>
                                        </ns:RetrieveIncidentListRequest>
                                   ]]>
            </body>
            <response>&gt;RetrieveIncidentListResponse</response>
            <instance>
              <container>instance</container>
              <typeattribute>type</typeattribute>
            </instance>
            <key>
              <container>keys</container>
              <instance>IncidentID</instance>
            </key>
          </getPollRecords>

          <!--=========================================
                                Incident Management Operations
                           =========================================-->

          <operation name="Update Incident Contact Info" enable="true">
            <menu>Service Center|Incident Update|Contact Name</menu>
            <prescript sub="false">
              <![CDATA[
                                        // @debug on
                                        // This operation has an example for all of the <prescript> pre-defined functions:
                                        //    ifNull, ifNullorEmpty, get, set, prompt, sendMessage, onOk, onCancel

                                        // Transform or validate any properties before prompting the user

                                        // Fix up non existing fields to be empty
										ifNull( "alarm.Contact", "")

                                        // Prompt for the information needed from the user
                                        // Choose property names that will be substituted into the <body> block below.
                                        prompt( 'Update Contact - Requested Info', true /* Close prompt dialog on Ok button press */,
                                        [
                                             ///// fields:                                                                                      combo box   combo box
                                             ///// property name,             prompt,          multiline?, password?,   default,                labels      values
                                             [ 'prop.update.action',    'Enter Update Action',    'true',  'false', 'Updated with Contact Info through Formula Operation', null, null ],
                                             [ 'prop.contact.name',     'Enter Contact Name',     'false', 'false', '{alarm.Contact}',     null,       null ],
                                        ] )

			                            // Statements after the prompt() will be executed right away. Place statements to be executed upon
                                        // user hitting the ok or cancel button in the onOk and onCancel functions.
                                        formula.log.debug( "Update Contact Info: Sent prompt to Client" )

                                        function onOk()
                                        {
                                            // This is the information after the user hit the ok button, but before the soap transaction is sent.
                                            // Provides an opportunity to do some final transforms or validation on the data before it is sent.
			                                // if there is no onOK() function and the user hits the ok button : perform the SOAP transaction
                                            // if there is no return statement : perform the SOAP transaction
                                            // return true : perform the SOAP transaction
                                            // return false : do not perform the SOAP transaction
											
                                        }

                                        function onCancel()
                                        {
                                            // Invoked if the user hits the cancel button. This function may do some cleanup or send
                                            // a message to the user. If the function can recover and set properties appropriately, 
                                            // the SOAP transaction will still be performed if 'return true' is the last statement.

                                            // Tell the user the operation has been cancelled
                                            sendMessage( "Operation has been cancelled." )

                                            // if there is no onCancel() function and the user hits the cancel button: do not perform the SOAP transaction
                                            // if there is no return statement : do not perform the SOAP transaction
                                            // return true : perform the SOAP transaction
                                            // return false : do not perform the SOAP transaction
                                        }
                                   ]]>
            </prescript>
            <name>UpdateIncident</name>
            <response>&gt;UpdateIncidentResponse</response>
            <envelope>{root.soap.envelope}</envelope>
            <body>
              <![CDATA[
                                        <ns:UpdateIncidentRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:IncidentID>{alarm.IncidentID}</ns:IncidentID>
                                                  </ns:keys>
                                                  <ns:instance>
                                                       <!-- The ServiceCenter fields to be updated -->
                                                       <ns:JournalUpdates>{prop.update.action}</ns:JournalUpdates>
													   <ns:ContactFirstName>{prop.contact.firstname}</ns:ContactFirstName>
													   <ns:ContactLastName>{prop.contact.lastname}</ns:ContactLastName>
                                                       <ns:Contact>{prop.contact.name}</ns:Contact>
                                                  </ns:nstance>
                                             </ns:model>
                                        </ns:UpdateIncidentRequest>
                                   ]]>
            </body>
            <message>
              <container>messages</container>
              <entry>cmn:message</entry>
            </message>
          </operation>

          <operation name="Update Incident Assignee Info" enable="true">
            <menu>Service Center|Incident Update|Assignee Info</menu>
            <prescript sub="false">
              <![CDATA[
                                        // Fix up fields
                                        ifNull( "alarm.Assignee", "" )
                                        ifNullorEmpty( "alarm.PrimaryAssignmentGroup", "DEFAULT" )

                                        // Prompt for the information needed from the user
                                        prompt( 'Update Assignee - Requested Info', true /* Close prompt dialog on Ok button press */,
                                        [
                                             ///// fields:                                                                              combo box   combo box
                                             ///// property name,          prompt,       multiline?, password?,   default,              labels      values                                             [ 'prop.assignee.name',  'Enter Assignee Name',   'false', 'false', '{assignee.name}',  null,       null ],
                                             [ 'prop.update.action', 'Enter Update Action', 'true',  'false',  'Updated with Assignee Info through Formula Operation', null, null ],
                                             [ 'prop.assignee.name', 'Enter Assignee Name', 'false', 'false',  '{alarm.Assignee}', null,       null ],
                                             [ 'prop.assignment',    'Select Assignment',   'false', 'false',  '{alarm.PrimaryAssignmentGroup}',    'Application|Hardware|Network|Service Desk|Service Manager', null ],
                                        ] )
                                   ]]>
            </prescript>
            <name>UpdateIncident</name>
            <response>&gt;UpdateIncidentResponse</response>
            <envelope>{root.soap.envelope}</envelope>
            <body>
              <![CDATA[
                                        <ns:UpdateIncidentRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:IncidentID>{alarm.IncidentID}</ns:IncidentID>
                                                  </ns:keys>
                                                  <ns:instance>
                                                       <!-- The ServiceCenter fields to be updated -->
                                                       <ns:JournalUpdates>{prop.update.action}</ns:JournalUpdates>
                                                       <ns:Assignee>{prop.assignee.name}</ns:Assignee>
                                                       <ns:AssignmentGroup>{prop.assignment}</ns:AssignmentGroup>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:UpdateIncidentRequest>
                                   ]]>
            </body>
            <message>
              <container>messages</container>
              <entry>cmn:message</entry>
            </message>
          </operation>

          <operation name="Create Incident" enable="true">
            <menu>Service Center|Incident Lifecycle|Create</menu>
            <prescript sub="false">
              <![CDATA[
                                        // Fix up fields
                                        var BriefDescription
                                        var IncidentDescription
                                        var ConfigurationItem
                                        var ProblemType
                                        var ProductType
                                        var Category
                                        var Subcategory
                                        var SiteCategory
                                        var Severity
                                        var UserPriority
                                        var PrimaryAssignmentGroup
                                        var Contact
										var UpdateAction = "Created through Formula Operation"
										
										if (isSet ("entryPoint", "element") == true)
										{ 
											BriefDescription       = ifNull("element.name", "")
											IncidentDescription    = ""
											ConfigurationItem      = ""
											ProblemType            = ""
											ProductType            = ""
											Category               = ""
											Subcategory            = ""
											SiteCategory           = ""
											Severity               = "5"
											UserPriority           = "5"
											PrimaryAssignmentGroup = "Application"
											Contact                = ""
										}
										else
										{
											BriefDescription       = ifNull( "alarm.BriefDescription", "" )
											IncidentDescription    = ifNull( "alarm.IncidentDescription", "" )
											ConfigurationItem      = ifNull( "alarm.ConfigurationItem", "" )
											ProblemType            = ifNull( "alarm.ProblemType", "" )
											ProductType            = ifNull( "alarm.ProductType", "" )
											Category               = ifNullorEmpty( "alarm.Category", "" )
											Subcategory            = ifNullorEmpty( "alarm.Subcategory", "" )
											SiteCategory           = ifNull( "alarm.SiteCategory", "" )
											Severity               = ifNullorEmpty( "alarm.Severity", "5" )
											UserPriority           = ifNullorEmpty( "alarm.UserPriority", "5" )
											PrimaryAssignmentGroup = ifNullorEmpty( "alarm.PrimaryAssignmentGroup", "DEFAULT" )
											Contact                = ifNull( "alarm.Contact", "" )
										}

                                        // Prompt for the information needed from the user
                                        // Choose property names that will be substituted into the <body> block below.
                                        prompt( 'New Incident - Requested Info', true /* Close prompt dialog on Ok button press */,
                                        [
                                             ///// fields:                                                                                   combo box   combo box
                                             ///// property name,          prompt,         multiline?, password?,     default,               labels      values
                                             [ 'prop.brief.descr',   'Enter Description',    'false',  'false', BriefDescription, null,       null ],
                                             [ 'prop.action',        'Enter Action',         'true',   'false', IncidentDescription,            null,       null ],
                                             [ 'prop.update.action', 'Enter Update Action',  'true',   'false', UpdateAction, null, null ],
                                             [ 'prop.impact',  'Enter Impact',   'false',  'false', null,      null,       null ],
                                             [ 'prop.problem.type',  'Enter Problem Type',   'false',  'false', ProblemType,      null,       null ],
                                             [ 'prop.product.type',  'Enter Product Type',   'false',  'false', ProductType,      null,       null ],
                                             [ 'prop.category',      'Enter Area',       'false',  'false', Category,          null,       null ],
                                             [ 'prop.subcategory',   'Enter Subarea',    'false',  'false', Subcategory,       null,       null ],
                                             [ 'prop.site.category', 'Enter Site Category',  'false',  'false', SiteCategory,     null,       null ],
                                             [ 'prop.severity.code', 'Select Severity Code', 'false',  'false', Severity,     'Severity 1|Severity 2|Severity 3|Severity 4|Severity 5', '1|2|3|4|5' ],
                                             [ 'prop.user.priority', 'Select User Priority', 'false',  'false', UserPriority,     'Priority 1|Priority 2|Priority 3|Priority 4|Priority 5', '1|2|3|4|5' ],
                                             [ 'prop.assignment',    'Select Assignment',    'false',  'false', PrimaryAssignmentGroup,        'Application|Hardware|Network|Service Desk|Service Manager', null ],
                                             [ 'prop.contact.name',  'Enter Contact Name',   'false',  'false', Contact,      null,       null ],
                                        ] )
                                   ]]>
            </prescript>
            <name>CreateIncident</name>
            <response>&gt;CreateIncidentResponse</response>
            <envelope>{root.soap.envelope}</envelope>
            <body>
              <![CDATA[
                                        <ns:CreateIncidentRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:IncidentID></ns:IncidentID>
                                                  </ns:keys>
                                                  <ns:instance>
                                                       <!-- The ServiceCenter fields to be updated -->
                                                       <ns:Title>{prop.brief.descr}</ns:Title>
                                                       <ns:Description>{prop.action}</ns:Description>
                                                       <ns:JournalUpdates>{prop.update.action}</ns:JournalUpdates>
                                                       <ns:Impact>{prop.impact}</ns:Impact>
                                                       <ns:Service>{prop.product.type}</ns:Service>
                                                       <ns:Area>{prop.category}</ns:Area>
                                                       <ns:Subarea>{prop.subcategory}</ns:Subarea>
                                                       <ns:Impact>{prop.site.category}</ns:Impact>
                                                       <ns:Urgency>{prop.severity.code}</ns:Urgency>                                                       
                                                       <ns:AssignmentGroup>{prop.assignment}</ns:AssignmentGroup>                                                       
                                                       <ns:Contact>{prop.contact.name}</ns:Contact>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:CreateIncidentRequest>
                                   ]]>
            </body>
            <message>
              <container>messages</container>
              <entry>cmn:message</entry>
            </message>
          </operation>

          <operation name="Resolve Incident Record Prompted" enable="true">
            <menu>Service Center|Incident Lifecycle|Resolve Prompted</menu>
            <prescript sub="false">
              <![CDATA[
                                        // Prompt for the information needed from the user
                                        // Choose property names that will be substituted into the <body> block below.
                                        prompt( 'Resolve Incident - Requested Info', true, [
                                             ///// fields:                                                                        combo box   combo box
                                             ///// property name,     prompt,                multiline?, password?, default,      labels      values
                                             ///// property name,     prompt,                multiline?, password?, default,      labels      values
                                             [ 'prop.fix.type',       'Enter Fix Type',         'false', 'false', 'permanent',    null,       null ],
                                             [ 'prop.resolution.code','Enter Resolution Code',  'false', 'false', 'User Resolved', null,      null ],
                                             [ 'prop.solution','Enter Solution',  'false', 'false', 'Solution Description', null,      null ],
                                        ] )
                                   ]]>
            </prescript>
            <name>ResolveIncident</name>
            <response>&gt;ResolveIncidentResponse</response>
            <envelope>{root.soap.envelope}</envelope>
            <body>
              <![CDATA[
                                        <ns:ResolveIncidentRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:IncidentID>{alarm.IncidentID}</ns:IncidentID>
                                                  </ns:keys>
                                                  <ns:instance>
                                                       <!-- The ServiceCenter fields to be updated -->
                                                       <ns:ResolutionFixType>{prop.fix.type}</ns:ResolutionFixType>
                                                       <ns:ClosureCode>{prop.resolution.code}</ns:ClosureCode>
                                                       <ns:Solution>{prop.solution}</ns:Solution>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:ResolveIncidentRequest>
                                   ]]>
            </body>
            <message>
              <container>messages</container>
              <entry>cmn:message</entry>
            </message>
          </operation>

          <operation name="Resolve Incident Record Unprompted" enable="true">
            <menu>Service Center|Incident Lifecycle|Resolve</menu>
            <name>ResolveIncident</name>
            <response>&gt;ResolveIncidentResponse</response>
            <envelope>{root.soap.envelope}</envelope>
            <body>
              <![CDATA[
                                        <ns:ResolveIncidentRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:IncidentID>{alarm.IncidentID}</ns:IncidentID>
                                                  </ns:keys>
                                                  <ns:instance>
                                                       <!-- The ServiceCenter fields to be updated -->
                                                       <ns:ResolutionFixType>'permanent'</ns:ResolutionFixType>
                                                       <ns:ClosureCode>'User Resolved'</ns:ClosureCode>
                                                       <ns:Solution>'Default Solution'</ns:Solution>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:ResolveIncidentRequest>
                                   ]]>
            </body>
            <message>
              <container>messages</container>
              <entry>cmn:message</entry>
            </message>
          </operation>

          <operation name="Close Incident Record" enable="true">
            <menu>Service Center|Incident Lifecycle|Close</menu>
            <name>CloseIncident</name>
            <response>&gt;CloseIncidentResponse</response>
            <envelope>{root.soap.envelope}</envelope>
            <body>
              <![CDATA[
                                        <ns:CloseIncidentRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:IncidentID>{alarm.IncidentID}</ns:IncidentID>
                                                  </ns:keys>
                                                  <ns:instance>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:CloseIncidentRequest>
                                   ]]>
            </body>
            <message>
              <container>messages</container>
              <entry>cmn:message</entry>
            </message>
          </operation>

          <operation name="Reopen Incident Record" enable="true">
            <menu>Service Center|Incident Lifecycle|Reopen</menu>
            <name>ReopenIncident</name>
            <response>&gt;ReopenIncidentResponse</response>
            <envelope>{root.soap.envelope}</envelope>
            <body>
              <![CDATA[
                                        <ns:ReopenIncidentRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:IncidentID>{alarm.IncidentID}</ns:IncidentID>
                                                  </ns:keys>
                                                  <ns:instance>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:ReopenIncidentRequest>
                                   ]]>
            </body>
            <message>
              <container>messages</container>
              <entry>cmn:message</entry>
            </message>
          </operation>

        </operations>
      </soap>
    </properties>
  </module>

  <!--===========================================================
     Configuration for the Change Management ServiceCenter Module
   ============================================================-->

	<module name="Change Management" enable="true">
          <!-- Define processing properties -->
          <properties>
               <formula>
                    <fields>
                         <!-- Formula expects 5 fields for normalization:
                              status, lastUpdate, key, description, assignedTo -->
                         <status>header.Phase</status>
                         <lastUpdate>header.DateEntered</lastUpdate>
                         <key>header.ChangeID</key>
                         <description>description.structure.Description</description>
                         <assignedTo>header.ChangeCoordinator</assignedTo>
                    </fields>
                    <severities>
                         <!-- Map normalized status field values to Formula Alarm Severities -->
                         <item fromRE="Change Logging" toSeverity="CRITICAL"/>
                         <item fromRE="Change Review" toSeverity="CRITICAL"/>
                         <item fromRE="Change Assessment &amp; Planning" toSeverity="MAJOR"/>
                         <item fromRE="Prepare for Change Approval" toSeverity="MAJOR"/>
                         <item fromRE="Change Approval" toSeverity="MINOR"/>
                         <item fromRE="Change Implementation" toSeverity="MINOR"/>
                         <item fromRE="Evaluation &amp; Change Closure" toSeverity="INFO"/>
                         <item fromRE=".*" toSeverity="INFO"/>
                    </severities>
               </formula>
               <soap>
                    <endpoint>{root.soap.endpoint.prefix}/ChangeManagement.wsdl</endpoint>
                    <namespace>{root.soap.namespace}</namespace>
                    <server>ChangeManagement</server>
                    <port>ChangeManagement</port>
                    <username>{adapter.username}</username>
                    <password>{adapter.password}</password>
                    <operations>


                         <!-- Polling Operations -->
                         <pollKeys>
                              <name>RetrieveChangeKeysList</name>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:RetrieveChangeKeysListRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys></ns:keys>
                                                  <ns:instance>
                                                       <ns:DateEntered>&gt;={formula.poll.from.time}</ns:DateEntered>
                                                       <ns:Open>true</ns:Open>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:RetrieveChangeKeysListRequest>
                                   ]]>
                              </body>
                              <response>&gt;RetrieveChangeKeysListResponse</response>
                              <instance>
                                   <container>keys</container>
                                   <typeattribute>type</typeattribute>
                              </instance>
                              <date>
                                   <initial>1900-01-01T00:00:00</initial>
                                   <format>yyyy-MM-dd''T''HH:mm:ss''+''hh</format>
                              </date>
                         </pollKeys>
                         <getPollRecords>
                              <name>RetrieveChangeList</name>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:RetrieveChangeListRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  {formula.poll.keys} 
                                             </ns:model>
                                        </ns:RetrieveChangeListRequest>
                                   ]]>
                              </body>
                              <response>&gt;RetrieveChangeListResponse</response>
                              <instance>
                                   <container>instance</container>
                                   <typeattribute>type</typeattribute>
                              </instance>
                              <key>
                                   <container>keys</container>
                                   <instance>ChangeID</instance>
                              </key>
                         </getPollRecords>


                         <!-- Other Operations -->

                         <operation name="MoveToNextPhase Change Record" enable="true">
                              <menu>Service Center|Change Lifecycle|Move To Next Phase</menu>
                              <name>MoveToNextPhaseChange</name>
                              <response>&gt;MoveToNextPhaseChangeResponse</response>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:MoveToNextPhaseChangeRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:ChangeID>{alarm.header.ChangeID}</ns:ChangeID>
                                                  </ns:keys>
                                                  <ns:instance>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:MoveToNextPhaseChangeRequest>
                                   ]]>
                              </body>
                              <message>
                                   <container>messages</container>
                                   <entry>cmn:message</entry>
                              </message>
                         </operation>

                         <operation name="Close Change Record" enable="true">
                              <menu>Service Center|Change Lifecycle|Close</menu> 
				<prescript sub="false">
                                   <![CDATA[
					ifNull("alarm.ClosureComments", "" )


                                        // Prompt for the information needed from the user
                                        // Choose property names that will be substituted into the <body> block below.
                                        prompt( 'Close Change Record - Requested Info', true /* Close prompt dialog on Ok button press */,
                                        [
                                             ///// fields:
                                             ///// property name,    	prompt,        		multiline?,	password?,	default,      	combo box labels	combo box values
                                             [ 'prop.closurecomments',      	'Enter Closure Comments',	'false',  	'false', 	'{alarm.ClosureComments}',          		null,   		null ],
                                        ] )
                                   ]]>
                              </prescript>

                              <name>CloseChange</name>
                              <response>&gt;CloseChangeResponse</response>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:CloseChangeRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:ChangeID>{alarm.header.ChangeID}</ns:ChangeID>
                                                  </ns:keys>
                                                  <ns:instance>
							<ns:ClosureComments>{prop.closurecomments}</ns:ClosureComments>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:CloseChangeRequest>
                                   ]]>
                              </body>
                              <message>
                                   <container>messages</container>
                                   <entry>cmn:message</entry>
                              </message>
                         </operation>
                    </operations>
                </soap>
           </properties>
      </module>

   <!--===========================================================
     Configuration for the Service Management ServiceCenter Module
   ============================================================-->

	<module name="Service Desk" enable="true">

          <!-- Define processing properties -->
          <properties>
               <formula>
                    <fields>
                         <!-- Formula expects 5 fields for normalization:
                              status, lastUpdate, key, description, assignedTo -->
                         <status>Status</status>
                         <lastUpdate>UpdateTime</lastUpdate>
                         <key>CallID</key>
                         <description>Description</description>
                         <assignedTo>CallOwner</assignedTo>
                    </fields>
                    <severities>
                         <!-- Map normalized status field values to Formula Alarm Severities -->
                         <item fromRE=".*Open.*" toSeverity="INFO"/>
                         <item fromRE=".*" toSeverity="MAJOR"/>
                    </severities>
               </formula>
               <soap>
                    <endpoint>{root.soap.endpoint.prefix}/ServiceDesk.wsdl</endpoint>
                    <namespace>{root.soap.namespace}</namespace>
                    <server>ServiceDesk</server>
                    <port>ServiceDesk</port>
                    <username>{adapter.username}</username>
                    <password>{adapter.password}</password>
                    <operations>

                         <!-- Polling Operations -->

                         <pollKeys>
                              <name>RetrieveInteractionKeysList</name>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:RetrieveInteractionKeysListRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys></ns:keys>
                                                  <ns:instance>
                                                       <ns:UpdatedTime>&gt;={formula.poll.from.time}</ns:UpdatedTime>
                                                       <ns:Status>&gt;&lt;Closed</ns:Status>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:RetrieveInteractionKeysListRequest>
                                   ]]>
                              </body>
                              <response>&gt;RetrieveInteractionKeysListResponse</response>
                              <instance>
                                   <container>keys</container>
                                   <typeattribute>type</typeattribute>
                              </instance>
                              <date>
                                   <initial>1900-01-01T00:00:00</initial>
                                   <format>yyyy-MM-dd''T''HH:mm:ss''+''hh</format>
                              </date>
                         </pollKeys>
                         <getPollRecords>
                              <name>RetrieveInteractionList</name>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:RetrieveInteractionListRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  {formula.poll.keys}
                                             </ns:model>
                                        </ns:RetrieveInteractionListRequest>
                                   ]]>
                              </body>
                              <response>&gt;RetrieveInteractionListResponse</response>
                              <instance>
                                   <container>instance</container>
                                   <typeattribute>type</typeattribute>
                              </instance>
                              <key>
                                   <container>keys</container>
                                   <instance>CallID</instance>
                              </key>
                         </getPollRecords>

                         <!-- Other Operations -->
                         <operation name="Close Call Record" enable="true">
                              <menu>Service Center|Call Lifecycle|Close</menu>
			      <prescript sub="false">
                                   <![CDATA[
					ifNull("alarm.Category", "" )
					ifNull("alarm.Area", "" )
					ifNull("alarm.Subarea", "" )


                                        // Prompt for the information needed from the user
                                        // Choose property names that will be substituted into the <body> block below.
                                        prompt( 'Close Interaction - Requested Info', true /* Close prompt dialog on Ok button press */,
                                        [
                                             ///// fields:
                                             ///// property name,    	prompt,        		multiline?,	password?,	default,      	combo box labels	combo box values
                                             [ 'prop.category',      	'Enter Category',	'false',  	'false', 	'{alarm.Category}',          		null,   		null ],
                                             [ 'prop.area',      	'Enter Area',		'false',  	'false', 	'{alarm.Area}',          		null,   		null ],
                                             [ 'prop.subarea', 		'Enter Subarea',	'false',  	'false', 	'{alarm.Subarea}',       		null,			null ],
                                             [ 'prop.closurecode',  	'Enter Closure Code',	'false',  	'false', 	'{alarm.ClosureCode}',      	null,			null ],
                                             [ 'prop.solution',		'Enter Solution',	'false',  	'false', 	'{alarm.Solution}', 		null,			null ],
                                        ] )
                                   ]]>
                              </prescript>
                              <name>CloseInteraction</name>
                              <response>&gt;CloseInteractionResponse</response>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:CloseInteractionRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:CallID>{alarm.CallID}</ns:CallID>
                                                  </ns:keys>
                                                  <ns:instance>
							<ns:Category>{prop.category}</ns:Category>
							<ns:Area>{prop.area}</ns:Area>
							<ns:Subarea>{prop.subarea}</ns:Subarea>
							<ns:Solution>{prop.solution}</ns:Solution>
							<ns:ClosureCode>{prop.closurecode}</ns:ClosureCode>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:CloseInteractionRequest>
                                   ]]>
                              </body>
                              <message>
                                   <container>messages</container>
                                   <entry>cmn:message</entry>
                              </message>
                         </operation>

                    </operations>
                </soap>
           </properties>

      </module>


   <!--===========================================================
     Configuration for the Inventory Management ServiceCenter Module
   ============================================================-->

	<module name="Inventory Management" enable="true">

          <!-- Define processing properties -->
          <properties>
               <formula>
                    <fields>
                         <status>Status</status>
                         <lastUpdate>sysmodtime</lastUpdate>
                         <key>ConfigurationItem</key>
                         <description>ConfigurationItem</description>
                         <assignedTo>AssignmentGroup</assignedTo>
                    </fields>
                    <severities>
                         <!-- Map normalized status field values to Formula Alarm Severities -->
                         <item fromRE="Available" toSeverity="OK"/>
                         <item fromRE="Installed" toSeverity="INFO"/>
                         <item fromRE="Replaced" toSeverity="INFO"/>
                         <item fromRE="Reserved" toSeverity="MINOR"/>
                         <item fromRE="Retired" toSeverity="IGNORE"/>
                         <item fromRE="RMA" toSeverity="INFO"/>
                         <item fromRE="Transfer" toSeverity="INFO"/>
                         <item fromRE="Warehouse" toSeverity="INFO"/>
                         <item fromRE=".*" toSeverity="MAJOR"/>
                    </severities>
               </formula>
               <soap>
                    <endpoint>{root.soap.endpoint.prefix}/ConfigurationManagement.wsdl</endpoint>
                    <namespace>{root.soap.namespace}</namespace>
                    <server>ConfigurationManagement</server>
                    <port>ConfigurationManagement</port>
                    <username>{adapter.username}</username>
                    <password>{adapter.password}</password>
                    <operations>

                         <!-- Polling Operations -->

                         <pollKeys>
                              <name>RetrieveDeviceKeysList</name>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:RetrieveDeviceKeysListRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys></ns:keys>
                                                  <ns:instance></ns:instance>
                                             </ns:model>
                                        </ns:RetrieveDeviceKeysListRequest>
                                   ]]>
                              </body>
                              <response>&gt;RetrieveDeviceKeysListResponse</response>
                              <instance>
                                   <container>keys</container>
                                   <typeattribute>type</typeattribute>
                              </instance>
                              <date>
                                   <initial>1900-01-01T00:00:00</initial>
                                   <format>yyyy-MM-dd''T''HH:mm:ss''+''hh</format>
                              </date>
                         </pollKeys>
                         <getPollRecords>
                              <name>RetrieveDeviceList</name>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:RetrieveDeviceListRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  {formula.poll.keys}
                                             </ns:model>
                                        </ns:RetrieveDeviceListRequest>
                                   ]]>
                              </body>
                              <response>&gt;RetrieveDeviceListResponse</response>
                              <instance>
                                   <container>instance</container>
                                   <typeattribute>type</typeattribute>
                              </instance>
                              <key>
                                   <container>keys</container>
                                   <instance>ConfigurationItem</instance>
                              </key>
                         </getPollRecords>

                         <!-- Other Operations -->

                         <operation name="Delete Device Record" enable="true">
                              <menu>Service Center|Device Lifecycle|Delete</menu>
                              <name>DeleteDevice</name>
                              <response>&gt;DeleteDeviceResponse</response>
                              <envelope>{root.soap.envelope}</envelope>
                              <body>
                                   <![CDATA[
                                        <ns:DeleteDeviceRequest {root.soap.xmlns}>
                                             <ns:model>
                                                  <ns:keys>
                                                       <ns:ConfigurationItem>{alarm.ConfigurationItem}</ns:ConfigurationItem>
                                                  </ns:keys>
                                                  <ns:instance>
                                                  </ns:instance>
                                             </ns:model>
                                        </ns:DeleteDeviceRequest>
                                   ]]>
                              </body>
                              <message>
                                   <container>messages</container>
                                   <entry>cmn:message</entry>
                              </message>
                         </operation>

                    </operations>
                </soap>
           </properties>
      </module>

</servicecenter>

